<!-- src/app/pages/login/login.html -->
<form class="login-form" #f="ngForm" (ngSubmit)="onLogin()" novalidate>
  <h2 class="login-title">ログイン</h2>

  <div *ngIf="!loggedIn">
    <!-- ユーザID -->
    <div class="login-form-row">
      <label for="userId">ユーザ ID</label>

      <div class="input-wrap">
        <input
          id="userId"
          type="text"
          [(ngModel)]="userId"
          name="userId"
          required
          #userIdCtrl="ngModel"
          placeholder="例）shin.yama"
          autocomplete="username"
        />
      </div>

      <div class="error" *ngIf="userIdCtrl.invalid && (userIdCtrl.touched || f.submitted)">
        {{ MSG.login.userIdRequired }}
      </div>
    </div>

    <!-- パスワード -->
    <div class="login-form-row">
      <label for="password">パスワード</label>

      <div class="input-wrap">
        <input
          id="password"
          type="password"
          [(ngModel)]="password"
          name="password"
          required
          minlength="5"
          #pwCtrl="ngModel"
          placeholder="5文字以上"
          autocomplete="current-password"
        />
      </div>

      <div class="error" *ngIf="pwCtrl.errors?.['required'] && (pwCtrl.touched || f.submitted)">
        {{ MSG.login.passwordRequired }}
      </div>

      <div class="error" *ngIf="pwCtrl.errors?.['minlength'] && (pwCtrl.touched || f.submitted)">
        {{ MSG.login.passwordMinLength }}
      </div>
    </div>

    <button type="submit" [disabled]="f.invalid || submitting">
      <span *ngIf="!submitting">ログイン</span>
      <span class="spinner" *ngIf="submitting" aria-label="ログイン中"></span>
    </button>
    <div class="error" *ngIf="loginErrorId">
      {{ MSG.login[loginErrorId] }}
    </div>

    <p class="note">ユーザID / パスワードは半角英数で入力してください</p>
  </div>

  <div *ngIf="loggedIn" class="after-login">
    <div class="success">ログイン成功</div>
    <p>ようこそ、{{ userId }} さん</p>

    <div class="admin-menu" *ngIf="isAdmin">
      <h3>管理メニュー</h3>
      <ul>
        <li>ユーザ一覧</li>
        <li>メッセージ管理</li>
        <li>システム設定</li>
      </ul>
    </div>

    <div class="user-menu" *ngIf="isUser">
      <h3>ユーザメニュー</h3>
      <ul>
        <li>プロフィール</li>
        <li>お知らせ</li>
      </ul>
    </div>

    <button type="button" (click)="logout()">ログアウト</button>
  </div>
</form>
